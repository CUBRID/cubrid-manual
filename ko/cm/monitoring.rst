********
모니터링
********

호스트 대시보드
===============


호스트 대시보드는 데이터베이스 서버의 운영 상태를 한눈에 볼 수 있는 상황판이다. 호스트 대시보드는 데이터베이스 볼륨 정보, 브로커 정보, 서버 상태 정보, 데이터베이스 정보, 시스템 정보로 구성되며, 호스트 접속을 하는 경우 자동으로 화면에 출력된다. 만약, 이미 로그인된 상태일 경우에는 오른쪽 마우스의 "호스트 대시보드 열기"를 선택하면 볼 수 있다. 현재 출력된 정보는 오른쪽 상단의 버튼으로 Excel 파일로 내려받기할 수 있다.

.. image:: /images/cm-dashboard.png

*   데이터베이스 볼륨 정보: 데이터베이스별 볼륨의 사용량을 확인할 수 있으며, 가용 공간이 5%이면 빨간색으로 15%이하이면 노란색으로 표시된다.

*   브로커 정보: 브로커 프로세스별 포트와 각종 상태 정보를 출력한다. 각종 상태 정보에 대한 상세 설명은 :ref:`broker-status`\ 를 참고한다.

*   서버 상태 정보: 현재, 5분 평균으로 현재 서버의 메모리, CPU, TPS, QPS 정보를 조회할 수 있다. 대시보드를 열게되면 15초 동안은 매 1초마다, 이후 매 30초마다 최근 상태를 출력한다. 만약, 우측 상단의 새로고침 버튼을 클릭하면 다시 15초 동안 매 1초마다 최근 상태를 출력한다.

*   데이터베이스 정보: 데이터베이스별 운영 상태를 확인할 수 있다. 자동시작에 선택을 한 후 창을 닫아 변경사항을 저장하게되면 다음에 서버를 재시작시 자동 시작되도록 할 수 있다.

*   시스템 정보: CUBRID, Broker 버전, 서버 경로 등을 조회한다.

데이터베이스 대시보드
=====================

데이터베이스 대시보드는 데이터베이스 사용현황, 볼륨 목록, 브로커(CAS), 잠김상태의 트랜젝션을 조회한다. 현재 출력된 정보는 오른쪽 상단의 버튼으로 Excel 파일로 내려받기할 수 있다.


.. image:: /images/cm-db-dashboard.png

*   데이터베이스: 해당 데이터베이스의 CPU, 메모리의 사용량과 QPS, 페이지 버퍼 Hit Ratio 정보가 출력된다. 최초 15초 동안 매 1초 마다, 이후 매 30초 마다 자동으로 새로고침이 되며, 우측 상단의 새로고침을 누르면 다시 15초 동안 매 1초 마다 새로 고침이 된다. 

*   볼륨: 데이터베이스를 구성하는 볼륨 목록이 출력된다. 마우스 오른쪽 클릭으로 볼륨을 추가할 수 있다.

*   브로커 (CAS): 실제 질의를 처리하는 브로커의 CAS 프로세스의 정보를 조회할 수 있다. 각 항목의 상세 설명은 CUBRID 설명서를 참고한다.

*   잠김 상태의 트랜잭션: LOCK 상태의 트랜젝션을 확인하고 트랜젝션을 취소하는 기능이다.

상태 모니터
===========

탐색 트리에서 "상태 모니터"를 마우스 오른쪽 버튼 클릭하고 "상태 모니터 추가"를 선택하면 아래와 같은 "템플릿 추가" 대화 상자가 나타나며, 모니터링 대상, 모니터링 항목 및 모니터링 차트 속성을 선택하여 모니터링 템플릿을 생성할 수 있다. 단, 3.0 미만 버전의 서버에 접속하는 경우 상태 모니터 추가창의 기능과 설정 방법이 다를 수 있다.

*   "모니터 종류": "DATABASE" 또는 "BROKER" 중 하나의 모니터링 대상을 선택할 수 있다.
*   "템플릿 이름": 생성할 상태 모니터링 템플릿의 이름을 입력한다.
*   "차트 제목" 탭: 차트 상단에 출력될 제목, 백그라운드 색상, 폰트 등을 설정할 수 있다.
*   "그림 모양" 탭: 차트 제목, 가로/세로 축 및 눈금선 등의 색상을 설정할 수 있다.
*   "계열 선택" 탭: 모니터링 항목을 선택할 수 있다.

데이터베이스 모니터링 항목
--------------------------

"모니터 종류"로 "DATABASE"를 선택하면, "계열 선택" 탭에서 원하는 데이터베이스 모니터링 항목을 선택하여 템플릿에 추가할 수 있다.
데이터베이스 모니터링은 cubrid statdump 유틸리티를 이용해 CUBRID 데이터베이스 서버가 실행한 통계 정보를 수집하여 보여 주며, 데이터 페이지 버퍼 적중률을 비롯하여 로그, 페이지, 인덱스, 질의, 트랜잭션과 같은 항목을 모니터링한다. 데이터베이스 모니터링 항목에 관한 보다 자세한 내용은 CUBRID 온라인 매뉴얼의 "데이터베이스 서버 실행 통계 정보 출력"을 참고한다.

브로커 모니터링 항목
--------------------

"모니터 종류"로 "BROKER"를 선택하면, "계열 선택" 탭에서 원하는 브로커 모니터링 항목을 선택하여 템플릿에 추가할 수 있다.
브로커 모니터링 항목은 SESSION, ACTIVE_SESSION, ERR_Q, LONG_Q, LONG_T, QPS, RPS, TPS가 있다. 자세한 내용은 CUBRID 온라인 매뉴얼의 "브로커 상태 확인"을 참고한다. 브로커의 ACTIVE_SESSION을 제외한 나머지 모니터링을 위한 샘플링 간격은 1초이다.

*   SESSION: 브로커에 현재 연결된 응용 서버(CAS) 개수를 의미한다. 즉, IDLE 상태가 아닌 응용 서버의 개수이다. 이 값은 브로커 파라미터 MAX_NUM_APPL_SERVER의 설정 값을 초과할 수 없다.
*   ACTIVE_SESSION: 브로커에 연결된 응용 서버(CAS) 중 현재 BUSY 상태인 응용 서버의 개수를 의미한다. 즉, 현재 트랜잭션을 수행 중인 세션의 개수를 의미한다.
*   ERR_Q: 에러가 발생한 질의 수이다.
*   LONG_Q: 장기 수행된 질의 수이다.
*   LONG_T: 장기 수행된 트랜잭션 수이다.
*   QPS: 브로커에서 처리한 초당 질의 수이다.
*   RPS: 브로커에 들어온 초당 요청 횟수이다.
*   TPS: 브로커에서 처리한 초당 트랜잭션 수이다.

템플릿 정보
-----------

*   이름: 새롭게 생성할 상태 모니터링 템플릿의 이름을 입력한다.
*   설명: 생성할 템플릿에 관한 설명을 입력한다.
*   샘플링 간격(초): 대상 객체를 모니터링할 주기를 초 단위로 지정한다.
*   대상 데이터베이스: 모니터링 대상 객체가 데이터베이스 서버와 관련된 경우 활성화되며, 대상 데이터베이스를 선택한다.

상태 모니터 수행
----------------

수행하려는 상태 모니터 템플릿을 마우스 오른쪽 버튼 클릭하고 "상태 모니터 수행"을 선택하면, 선택한 템플릿에 따라 데이터베이스 서버와 브로커의 상태를 모니터링할 수 있는 상태 모니터링 창이 나타난다. 상태 모니터는 각 수집 항목별로 별도의 차트를 보여 주며, 현재 값, 최소 값, 최대 값 그리고 평균 값으로 구성되어 있다.
상태 모니터는 별도의 뷰로 구성되어 있어 다른 뷰 인터페이스와 동시에 볼 수 있으며, CUBRID 매니저 외부로 끌어내어 볼 수도 있으므로, 다중 모니터 환경에서 작업과 상태 모니터링을 동시에 할 때 편리하다.

통합 상태 모니터
================

통합 상태 모니터링은 브로커 및 데이터베이스 모니터링 항목을 하나의 차트로 통합하여 확인할 수 있는 기능이다. CUBRID 2008 R2.2 이상 버전에서 지원한다.

브로커 상태 모니터
------------------

하나의 차트에서 브로커 관련 항목을 통합 모니터링할 수 있다. 브로커 상태 모니터링 창의 상단 바에 있는 "설정"을 클릭해서 모니터링 항목과 차트 속성을 설정할 수 있다.

데이터베이스 상태 모니터
------------------------

하나의 차트에서 데이터베이스 관련 항목을 통합 모니터링할 수 있다. 모니터링할 수 있는 항목은 cubrid statdump 유틸리티 실행 시 출력되는 항목과 같다. 데이터베이스 상태 모니터링 창의 상단 바에 있는 "설정"을 클릭해서 모니터링 항목과 차트 속성을 설정할 수 있다.

차트 속성 설정
--------------

차트 설정 마법사를 이용해서 차트 제목, 그림 모양, 모니터링 항목을 설정할 수 있다.

대시보드 관리
=============

메뉴에서 "도구 > 대시보드 탐색기 열기"를 선택하면, "호스트" 탭 옆에 "대시보드" 탭이 나타난다. 대시보드는 CUBRID 2008 R3.1 이상 버전에서 지원한다.

대시보드 추가
-------------

"대시보드" 탭에서 마우스 오른쪽 버튼을 클릭하여 "대시보드 추가"를 선택하면, "모니터링 대시보드 추가" 대화 상자가 나타난다. "대시보드 이름"에 대시보드 이름을 지정하고 "추가"를 클릭한다.

1단계: 호스트 정보 설정
^^^^^^^^^^^^^^^^^^^^^^^

모니터링할 데이터베이스 서버의 호스트 정보를 입력한다. 이때, 해당 호스트에는 CUBRID 매니저 서버가 구동 중이어야 한다.
별칭 이름: 해당 호스트 정보에 부여하는 별칭을 입력한다. 생략하면 호스트 주소가 사용된다.

*   주소: 해당 호스트의 IP 주소를 입력한다.
*   포트: 해당 호스트에 설치된 CUBRID 매니저 서버의 cm_port 값을 입력한다. cm_port 값은 $CUBRID/conf/cm.conf 파일에서 확인할 수 있다.
*   비밀번호: CUBRID 매니저 관리자(admin)의 비밀번호를 입력한다.
*   연결 시험: 입력된 호스트 정보로 접속이 가능한지 검증한다. 성공했을 때만 다음 단계로 이동할 수 있다.

2단계: 데이터베이스 선택
^^^^^^^^^^^^^^^^^^^^^^^^

해당 호스트에 설치된 데이터베이스 중 모니터링하고자 하는 데이터베이스를 선택한다.

*   별칭 이름:  해당 데이터베이스 정보에 부여하는 별칭을 입력한다. 생략하면 데이터베이스 이름이 사용된다.
*   DBA 비밀번호: 해당 데이터베이스의 DBA 사용자 비밀번호를 입력한다.
*   HA 방식: 해당 데이터베이스가 HA 구성(ha_mode=on)되어 있으면 자동으로 선택된다.
*   데이터베이스 추가: 입력된 데이터베이스 정보로 해당 데이터베이스에 접속이 가능한지 검증한 후 데이터베이스 리스트에 추가한다. 해당 데이터베이스가 HA 구성되어 있으면, HA 구성된 나머지 데이터베이스를 검출하여 추가할 수 있는 창이 출력된다.
*   HA 데이터베이스 추가: 해당 데이터베이스가 HA 구성된 경우, HA 구성된 나머지 데이터베이스를 추가할 수 있다.
*   삭제: 데이터베이스 리스트에 등록된 정보를 삭제한다.

2-1단계: HA 데이터베이스 추가
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

2단계에서 "HA 데이터베이스 추가"를 클릭하면 HA 구성된 나머지 노드를 추가할 수 있다. standby 노드를 추가할지 확인하는 창에서 "예"를 클릭하면 "HA 데이터베이스 추가" 대화 상자에서 standby 노드의 호스트 정보와 데이터베이스 정보를 입력할 수 있다.

*   포트: 해당 호스트에 설치된 CUBRID 매니저 서버의 cm_port 값을 입력한다. cm_port 값은 $CUBRID/conf/cm.conf 파일에서 확인할 수 있다.
*   비밀번호: CUBRID 매니저 관리자(admin)의 비밀번호를 입력한다.
*   DBA 비밀번호: 해당 데이터베이스의 DBA 사용자 비밀번호를 입력한다.
*   데이터베이스 추가: 입력된 데이터베이스 정보로 해당 데이터베이스에 접속이 가능한지 검증한 후 데이터베이스 리스트에 추가한다.
*   삭제: 데이터베이스 리스트에 등록된 정보를 삭제한다.
*   3단계: 브로커 선택
*   해당 호스트에서 구동 중인 브로커를 선택하여 모니터링 대상으로 추가할 수 있다.
*   별칭 이름: 해당 브로커 이름의 별칭을 입력한다. 생략하면 브로커 이름이 사용된다.
*   브로커 추가: 해당 브로커를 브로커 리스트에 추가한다.
*   삭제: 브로커 리스트에 등록된 정보를 삭제한다.

대시보드 창 관리
----------------

마우스나 키보드 방향 키를 사용하여 대시보드 창에 표시된 대상 객체의 위치를 사용자가 조정할 수 있다. 조정한 위치 정보는 CUBRID 매니저 클라이언트가 설치된 로컬 디렉터리에 저장되어, 항상 마지막으로 저장된 위치 정보에 따라 객체를 표시한다. <Ctrl> 키를 누른 상태에서 마우스 휠을 움직이거나 <+> 키 또는 <-> 키를 누르면 화면의 배율을 조절할 수 있다.

대시보드 창에서 마우스 오른쪽 버튼 클릭하면 다음과 같은 바로가기 메뉴가 나타난다.

*   모두 선택: 대시보드 창에 표시된 객체 전부를 선택하여 위치를 이동할 수 있다.
*   호스트 모니터 추가: 해당 대시보드에 모니터링하고자 하는 새로운 호스트 정보를 추가할 수 있다.
*   새로 고침: 해당 대시보드를 수동으로 새로 읽어들인다.

대시보드 - 호스트 모니터
========================

데이터베이스 또는 브로커가 구동 중인 호스트를 모니터링하며, 해당 호스트의 CPU, MEMORY, IO WAIT 항목의 현재 값을 퍼센트 단위로 보여준다. 호스트 모니터를 마우스 오른쪽 버튼 클릭하면 다음과 상세 기능을 설정할 수 있는 바로가기 메뉴가 나타난다.

상세 정보 보기
--------------

"상세 정보 보기"는 해당 호스트의 CPU, MEMORY, IO WAIT 상태의 시간에 따른 변화를 보여준다.
오른쪽 위의 차트 설정을 클릭하면 차트 속성을 설정할 수 있다.

*   그림 모양: 호스트 모니터 차트의 배경색과 가로 세로 눈금선의 색상을 설정한다.
*   계열 선택: 호스트 모니터 차트에 보여줄 항목을 선택하고 해당 항목 그래프의 색상 및 선 굵기를 설정한다.
*   저장 설정: 기록 기능을 실행했을 때 기록한 내용을 저장할 디렉토리를 설정한다.
*   차트 선택: 모니터링할 차트를 선택한다.

오른쪽 위의 기록 시작을 클릭하면 현재 모니터링 중인 모든 수치 데이터를 로컬에 저장하여 이후 차트에서 다시 확인할 수 있다. 기록을 중지하려면 기록 중지를 클릭하면 된다.

모니터링 기록 정보 보기
-----------------------

기록한 모니터링 정보를 확인할 수 있는 기능이다. 일자, 시간을 입력하여 특정 시간 대의 항목 값 추이를 확인할 수 있다.

대시보드 - 데이터베이스 모니터
==============================

운영 중인 데이터베이스 서버를 모니터링하며, 해당 데이터베이스 서버의 CPU, MEMORY, HA 지연(msec) 항목의 현재 값을 보여준다. 데이터베이스 모니터를 마우스 오른쪽 버튼 클릭하면 다음과 상세 기능을 설정할 수 있는 바로가기 메뉴가 나타난다.

상세 정보 보기
--------------

"상세 정보 보기"는 해당 데이터베이스 서버의 CPU 사용 정보, 메모리 정보, HA 지연 정보 항목의 시간에 따른 변화를 보여준다.
오른쪽 위의 차트 설정을 클릭하면 차트 속성을 설정할 수 있다.

*   그림 모양: 데이터베이스 모니터 차트의 배경색과 가로 세로 눈금선의 색상을 설정한다.
*   계열 선택: 데이터베이스 모니터 차트에 보여줄 항목을 선택하고 해당 항목 그래프의 색상 및 선 굵기를 설정한다. 기본값으로 data_page_buffer_hit_ratio와 num_data_page_fetches가 설정되어 있으며, cubrid statdump에서 보여 주는 모든 항목을 설정할 수 있다. 단, 동시에 다른 터미널에서 cubrid statdump 명령을 실행하면 부정확한 값이 출력될 수 있다.
*   저장 설정: 기록 기능을 실행했을 때 기록한 내용을 저장할 디렉토리를 설정한다.
*   차트 선택: 모니터링할 차트를 선택한다.

오른쪽 위의 기록 시작을 클릭하면 현재 모니터링 중인 모든 수치 데이터를 로컬에 저장하여 이후 차트에서 다시 확인할 수 있다. 기록을 중지하려면 기록 중지를 클릭하면 된다.

모니터링 기록 정보 보기
-----------------------

기록한 모니터링 정보를 확인할 수 있는 기능이다. 일자, 시간을 입력하여 특정 시간 대의 항목 값 추이를 확인한다.

HA 적용 로그 보기
-----------------

HA 구성된 standby 데이터베이스 서버에서 활성화되는 기능이며, cubrid applylogdb 명령 수행 시 발생한 로그를 확인한다.

HA 복사 로그 보기
-----------------

HA 구성된 active 데이터베이스 서버에서 활성화되는 기능이며, cubrid copylogdb 명령 수행 시 발생한 로그를 확인한다.


대시보드 - 브로커 모니터
========================

운영 중인 브로커를 모니터링하며, 해당 브로커의 session 수, active session 수, TPS 항목의 현재 값을 보여준다. 브로커 모니터를 마우스 오른쪽 버튼 클릭하면 다음과 상세 기능을 설정할 수 있는 바로가기 메뉴가 나타난다.

상세 정보 보기
--------------

"상세 정보 보기"는 해당 브로커에 대한 항목 값을 보여준다.

모니터링 기록 정보 보기
-----------------------

기록한 모니터링 정보를 확인할 수 있는 기능이다. 일자, 시간을 입력하여 특정 시간 대의 항목 값 추이를 확인한다.

연결된 클라이언트 보기
----------------------

해당 브로커에 접속한 응용 클라이언트의 정보를 표시하는 창을 활성화시킨다. 접속한 응용 클라이언트의 IP 주소가 표시된다.

연결된 데이터베이스 보기
------------------------

해당 브로커를 통해 접속하는 데이터베이스 정보를 확인한다. 해당 정보는 브로커 모니터링 항목 중 DB 항목 값을 기준으로 표시된다.

호스트 보기
-----------

해당 브로커가 구동 중인 호스트 정보를 확인한다.

